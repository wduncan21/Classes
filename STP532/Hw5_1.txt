> library(NSM3)
> allergy<-read.table("B:\\dropbox\\class\\Spring 2014\\STP532\\allergy.txt",header=T)
> attach(allergy)
下列对象被屏蔽了from allergy (position 3):

    x, y
下列对象被屏蔽了from allergy (position 4):

    x, y
> ynx<-c(x,y)
> sortYnx<-sort(ynx)
> sortYnx
 [1]    4.7    5.2    6.6   18.9   27.3   29.1   31.0   32.4   34.3   35.4   39.6   41.7   45.5   48.0   48.1   64.7   65.9
[18]   67.6  100.0  102.4 1112.0 1651.0
> rank(sortYnx)
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22

 #small sample
> W=1+2+3+4+5+6+8+10+11+12+13+14+15+16
> W
[1] 120
> pwilcox(0:117,9,13)
  [1] 2.010374e-06 4.020747e-06 8.041494e-06 1.407261e-05 2.412448e-05 3.819710e-05 6.031121e-05 9.046681e-05 1.346950e-04
 [10] 1.950062e-04 2.774315e-04 3.859917e-04 5.327490e-04 7.217241e-04 9.669897e-04 1.278598e-03 1.674641e-03 2.167183e-03
 [19] 2.782357e-03 3.534237e-03 4.454988e-03 5.566724e-03 6.903623e-03 8.493828e-03 1.038358e-02 1.260102e-02 1.519641e-02
 [28] 1.820795e-02 2.168791e-02 2.567649e-02 3.023401e-02 3.539866e-02 4.123276e-02 4.777854e-02 5.509027e-02 6.320815e-02
 [37] 7.219050e-02 8.206345e-02 9.287524e-02 1.046520e-01 1.174259e-01 1.312090e-01 1.460255e-01 1.618672e-01 1.787423e-01
 [46] 1.966326e-01 2.155181e-01 2.353645e-01 2.561437e-01 2.777934e-01 3.002634e-01 3.234852e-01 3.473845e-01 3.718769e-01
 [55] 3.968799e-01 4.222910e-01 4.480178e-01 4.739576e-01 5.000000e-01 5.260424e-01 5.519822e-01 5.777090e-01 6.031201e-01
 [64] 6.281231e-01 6.526155e-01 6.765148e-01 6.997366e-01 7.222066e-01 7.438563e-01 7.646355e-01 7.844819e-01 8.033674e-01
 [73] 8.212577e-01 8.381328e-01 8.539745e-01 8.687910e-01 8.825741e-01 8.953480e-01 9.071248e-01 9.179366e-01 9.278095e-01
 [82] 9.367918e-01 9.449097e-01 9.522215e-01 9.587672e-01 9.646013e-01 9.697660e-01 9.743235e-01 9.783121e-01 9.817920e-01
 [91] 9.848036e-01 9.873990e-01 9.896164e-01 9.915062e-01 9.930964e-01 9.944333e-01 9.955450e-01 9.964658e-01 9.972176e-01
[100] 9.978328e-01 9.983254e-01 9.987214e-01 9.990330e-01 9.992783e-01 9.994673e-01 9.996140e-01 9.997226e-01 9.998050e-01
[109] 9.998653e-01 9.999095e-01 9.999397e-01 9.999618e-01 9.999759e-01 9.999859e-01 9.999920e-01 9.999960e-01 9.999980e-01
[118] 1.000000e+00

> 33+9*13/2
[1] 91.5


#large sample below
> EW=13*(9+13+1)/2
> VW=9*13*(9+13+1)/12
> SW=(W-EW)/(VW)^0.5
> SW
[1] -1.969953
> qnorm(0.05)
[1] -1.644854
#delta one
> z<-rep(NA,117)
> k=1
> for (i in 1:9)
+ { for (j in 1:13)
+ {z[k]<-x[i]-y[j]
+  k<-k+1}
+ }
> sort(z)
  [1]  -17.1  -17.0  -14.5  -10.7   -8.5   -8.4   -5.9   -4.4   -3.3   -2.1   -1.4    1.9    3.7    4.2    5.3    7.2   10.5
 [18]   12.1   12.3   16.6   16.7   17.8   17.9   19.2   19.5   19.6   20.4   20.7   22.1   23.0   24.2   24.4   25.8   25.9
 [35]   26.3   29.3   30.4   30.5   31.6   32.2   32.3   33.0   33.3   33.5   34.4   34.9   35.2   35.6   36.8   37.4   38.5
 [52]   38.6   40.3   45.8   47.0   48.7   51.9   52.0   54.3   54.4   54.5   56.9   58.1   58.3   59.3   59.5   60.0   60.7
 [69]   60.7   61.0   61.2   62.4   62.9   64.6   65.7   67.0   67.6   68.1   70.0   70.9   72.7   73.3   75.1   81.1   83.5
 [86]   93.4   94.8   95.3   95.8   97.2   97.7 1063.9 1064.0 1066.5 1070.3 1076.6 1077.7 1079.6 1082.9 1084.7 1093.1 1105.4
[103] 1106.8 1107.3 1602.9 1603.0 1605.5 1609.3 1615.6 1616.7 1618.6 1621.9 1623.7 1632.1 1644.4 1645.8 1646.3

#delta two
> zx<-rep(NA,45)
> k=1
> for (i in 1:9)
+ { for (j in i:9)
+ {zx[k]<-(x[i]+x[j])/2
+  k<-k+1}
+ }
> median(zx)
[1] 83.8
> 
> zy<-rep(NA,91)
> k=1
> for (i in 1:13)
+ { for (j in i:13)
+ {zy[k]<-(y[i]+y[j])/2
+  k<-k+1}
+ }
> median(zy)
[1] 29.85

> wilcox.test(x,y,conf.int=T)

	Wilcoxon rank sum test

data:  x and y
W = 106, p-value = 0.000772
alternative hypothesis: true location shift is not equal to 0
95 percent confidence interval:
 22.1 95.8
sample estimates:
difference in location 
                  54.3 
				  
